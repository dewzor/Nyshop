@model Webshop.Models.Product
    
@{
    ViewBag.Title = Model.Name + " Details";
}

<h2>@Model.Name</h2>

<p>
    <img class="product-image" alt="@Model.Name" src="@Url.Content(Model.ImageUrl)"/>
</p>

<div id="category-details">
    <p>
        <em>Category:</em>
        @Model.Category.Name
    </p>
    <p>
        <em>Price:</em>
        @Html.DisplayFor(m => m.Price)
    </p>
    <p>
        <em>Description:</em>
        @Html.DisplayFor(m => m.Description)
    </p>
    <p class="button">
        @Html.ActionLink("Add to cart", "AddtoCart", new {controller = "ShoppingCart", id = Model.ProductId})
    </p>
    @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
    {
        <p>
            @Html.ActionLink("Edit product", "EditProduct", new {controller = "Admin", id = Model.ProductId})
        </p>
    }
    @Html.Partial(ReviewProduct)
    <div class="reviews">
        
    </div>

</div>
<script type="text/javascript">
    var url = '/api/review/'+@Model.ProductId;
    $(document).ready(function() {
        $.getJSON(url).done(function(data) {
            $.each(data, function(key, post) {
                $('<li>', { text: insertitem(post) }, '</li>').appendTo($('.reviews'));
            });
        });
    });

    function insertitem(post) {
        return post.CustomerId + ": " + post.Comment;
    }
</script>